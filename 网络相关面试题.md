### 网络相关

- [网络相关](#toc_0)

- - [TCP粘包和拆包产生的原因](#toc_1)
  - [TCP粘包和拆包的解决策略](#toc_2)
  - [三次握手](#toc_3)
  - [四次握手](#toc_4)
  - [一次完整的HTTP请求过程](#toc_5)
  - [讲一下长连接](#toc_6)

- - - [基于http协议的长连接](#toc_7)
    - [发心跳包](#toc_8)

- - [HTTP 2.0 和 1.1 区别](#toc_9)
  - [HTTPS和HTTP的区别](#toc_10)
  - [简述Http请求get和post的区别以及数据包格式](#toc_11)
  - [Https的加密方式](#toc_12)
  - [Session和cookie的区别。](#toc_13)
  - [http请求报文结构和内容](#toc_14)
  - [http三次握手和四次挥手](#toc_15)
  - [OSI有哪七层模型？TCP/IP是哪四层模型。](#toc_16)

------

#### TCP粘包和拆包产生的原因

应用程序写入数据的字节大小大于套接字发送缓冲区的大小

进行MSS大小的TCP分段。MSS是最大报文段长度的缩写。MSS是TCP报文段中的数据字段的最大长度。数据字段加上TCP首部才等于整个的TCP报文段。所以MSS并不是TCP报文段的最大长度，而是：MSS=TCP报文段长度-TCP首部长度

以太网的payload大于MTU进行IP分片。MTU指：一种通信协议的某一层上面所能通过的最大数据包大小。如果IP层有一个数据包要传，而且数据的长度比链路层的MTU大，那么IP层就会进行分片，把数据包分成托干片，让每一片都不超过MTU。注意，IP分片可以发生在原始发送端主机上，也可以发生在中间路由器上。

#### TCP粘包和拆包的解决策略

- 消息定长。例如100字节。
- 在包尾部增加回车或者空格符等特殊字符进行分割，典型的如FTP协议
- 将消息分为消息头和消息尾。
- 其它复杂的协议，如RTMP协议等。

#### 三次握手

- 第一次握手：建立连接时，客户端发送syn包(syn=j)到服务器，并进入SYN_SEND状态，等待服务器确认；
- 第二次握手：服务器收到syn包，必须确认客户的SYN（ack=j+1），同时自己也发送一个SYN包（syn=k），即SYN+ACK包，此时服务器进入SYN_RECV状态；
- 第三次握手：客户端收到服务器的SYN＋ACK包，向服务器发送确认包ACK(ack=k+1)，此包发送完毕，客户端和服务器进入ESTABLISHED状态，完成三次握手。

完成三次握手，客户端与服务器开始传送数据

#### 四次握手

- 客户端先发送FIN，进入FIN_WAIT1状态
- 服务端收到FIN，发送ACK，进入CLOSE_WAIT状态，客户端收到这个ACK，进入FIN_WAIT2状态
- 服务端发送FIN，进入LAST_ACK状态
- 客户端收到FIN，发送ACK，进入TIME_WAIT状态，服务端收到ACK，进入CLOSE状态

TIME_WAIT的状态就是主动断开的一方（这里是客户端），发送完最后一次ACK之后进入的状态。并且持续时间还挺长的。客户端TIME_WAIT持续2倍MSL时长，在linux体系中大概是60s，转换成CLOSE状态

#### 一次完整的HTTP请求过程

域名解析 --> 发起TCP的3次握手 --> 建立TCP连接后发起http请求 --> 服务器响应http请求，浏览器得到html代码 --> 浏览器解析html代码，并请求html代码中的资源（如js、css、图片等） --> 浏览器对页面进行渲染呈现给用户

#### 讲一下长连接

#### 基于http协议的长连接

在HTTP1.0和HTTP1.1协议中都有对长连接的支持。其中HTTP1.0需要在request中增加”Connection： keep-alive“ header才能够支持，而HTTP1.1默认支持.

#### 发心跳包

#### HTTP 2.0 和 1.1 区别

- 区别一：多路复用
  多路复用允许单一的 HTTP/2 连接同时发起多重的请求-响应消息。看个例子：
  ![img](https://cdn.nlark.com/yuque/0/2019/png/406432/1565343607316-fd3bd4a3-78f9-4cbf-b833-781ad149c5c4.png)
  多路复用技术：单连接多资源的方式，减少服务端的链接压力,内存占用更少,连接吞吐量更大；由于减少TCP 慢启动时间，提高传输的速度
- 区别二：首部压缩
- 区别三：HTTP2支持服务器推送

#### HTTPS和HTTP的区别

- https协议需要到CA申请证书，一般免费证书很少，需要交费。
- http是超文本传输协议，信息是明文传输；https 则是具有安全性的ssl加密传输协 议。
- http和https使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443。
- http的连接很简单，是无状态的；HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，比http协议安全。
- http默认使用80端口，https默认使用443端口

#### 简述Http请求get和post的区别以及数据包格式

- 两种动作不一样，get是获取资源，post是提交资源 
- get参数在URL中不安全，post是放在http body中的相对安全 
- get传输字节数受限于URL长度，post无限制 
- 后台获取数据的方式get只能是QueryString, post可从InputStream中获取 
- base64编码后有+=特殊符号的会转码不能经get传输，如果是改进的base64会替换掉特殊符号可以用get传输。

#### Https的加密方式

#### Session和cookie的区别。

#### http请求报文结构和内容

#### http三次握手和四次挥手

#### OSI有哪七层模型？TCP/IP是哪四层模型。